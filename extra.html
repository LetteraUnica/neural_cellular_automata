<!doctype html>
<meta charset="utf-8">
<script src="website/template.js"></script>
<script async src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-68SGYK1XFT"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-68SGYK1XFT');
</script>
<link async rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.18/dist/katex.min.css" integrity="sha384-zTROYFVGOfTw7JV7KUu8udsvW2fx4lWOsCEDqhBreBwlHI4ioVRtmIvEThzJHGET" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.18/dist/katex.min.js" integrity="sha384-GxNFqL3r9uRJQhR+47eDxuPoNE7yLftQM8LcxzgS4HT73tp970WS/wV5p8UzCOmb" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.18/dist/contrib/auto-render.min.js" integrity="sha384-vZTG03m+2yp6N6BNi5iM4rW4oIwk5DfcNdFfxkk9ZWpDriOkXX8voJBFrAO7MpVl" crossorigin="anonymous"></script>
<script async>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement(document.body, {
          // customised options
          // • auto-render specific keys, e.g.:
          delimiters: [
              {left: '$$', right: '$$', display: true},
              {left: '$', right: '$', display: false},
              {left: '\\(', right: '\\)', display: false},
              {left: '\\[', right: '\\]', display: true}
          ],
          // • rendering keys, e.g.:
          throwOnError : false
        });
    });
</script>

<script type="text/front-matter">
    title: "Adversarial Takeover of Neural Cellular Automata extra resources"
    description: "Description of the post"
    authors:
    - Lorenzo Cavuoti: https://github.com/LetteraUnica
    - Francesco Sacco: https://github.com/Francesco215
    - Ettore Randazzo: https://oteret.github.io
    - Michael Levin: https://ase.tufts.edu/biology/labs/levin/
    affiliations:
    - University of Trieste: http://units.it
    - University of Pisa: http://unipi.it
    - Google: https://ai.google/
    - Allen Discovery Center: https://allencenter.tufts.edu
  </script>

<dt-article>
  <h1>Adversarial Takeover of Neural Cellular Automata</h1>
  <dt-byline></dt-byline>
  
  <br/>
  <div style="position:relative; height:30px; display:flex">
    <div style="width:33%; top:0px; text-align:center; font-size:32px; font-family: 'Times New Roman', Times, serif;"><a href="https://github.com/LetteraUnica/neural_cellular_automata">Code</a></div>
    <div style="width:33%; top:0px; left:275px; text-align:center; font-size:32px; font-family: 'Times New Roman', Times, serif;"><a href="https://colab.research.google.com/drive/1Jh7MZPxE_05-04neyX2XxYbvq1O457aG?usp=sharing">Colab</a></div>
    <div style="width:33%; top:0px; left:560px; text-align:center; font-size:32px; font-family: 'Times New Roman', Times, serif;">Article</div>
  </div>

  
  <h2 style="font-size: 40px;" id="nca-types">NCA types</h2>
  
  <p>
    There are three different types of NCA:
    <ul>
      <li>Growing: A NCA that grows into a final state and then decays, this represents growing and aging biological organisms.</li>
      <li>Persistent: A NCA that grows into a final state and keeps it for an infinite amount of time, 
        some biological organisms like lobsters have this property.</li>
      <li>Regenerating: A Persistent NCA that is able to regenerate damage, biological examples of these are planarians.</li>
    </ul>
  </p>
  <figure class="l-body">
    <video loop="" autoplay="" playsinline="" muted="" width="100%" height="100%">
      <source src="website/videos/firework_grow_persist_regen.mp4" type="video/mp4" id="grow-persist-regen">
      Your browser does not support the video tag.
    </video>
    <div style="position:relative; height:30px; display:flex">
        <div style="width:33%; top:0px; text-align:center">Growing</div>
        <div style="width:33%; top:0px; left:275px; text-align:center">Persistent</div>
        <div style="width:33%; top:0px; left:560px; text-align:center">Regenerating</div>
    </div>
    <figcaption style="align-self: center; margin-top: 20px; margin-bottom: 25px; width: 100%" >
      Video 1: Example of the three types of Neural Cellular Automata
    </figcaption>
  </figure>

  <dt-byline></dt-byline> 

  <h2 style="font-size: 40px;">Experiments</h2>
  
  <div class="body" style="margin-top: 70px;">
    <h2 style="margin-top: 0em;" id="static-properties">Changing static properties</h2>

    <p>Below we show the evolution of the lizard and bug Persistent NCA used in the static properties experiment</p>
    <figure class="l-center">
      <video controls="" muted="" width="100%" height="100%">
        <source src="website/videos/static_properties/lizard_and_bug_persist.mp4" type="video/mp4" id="lizard-bug-persist">
        Your browser does not support the video tag.
      </video>
      <figcaption style="align-self: center; margin-top: 20px; margin-bottom: 25px; width: 100%" >
        Video 2: left: a persistent lizard, right: a persistent bug.
      </figcaption>
    </figure>

    <p>Below, the left panel shows the evolution of the organism,
      while the right panel shows where the cells are located, orange being the original cells and blue the adversaries.
    </p>
    <figure class="l-center">
      <video controls="" muted="" width="100%" height="100%">
        <source src="website/videos/static_properties/lizard_persist_to_red_square_2.mp4" type="video/mp4" id="red-lizard">
        Your browser does not support the video tag.
      </video>
      <figcaption style="align-self: center; margin-top: 20px; margin-bottom: 25px; width: 100%" >
        Video 3: red lizard experiment.
      </figcaption>
    </figure>
    <br/>

    <figure class="l-center">
      <video controls="" muted="" width="100%" height="100%">
        <source src="website/videos/static_properties/lizard_persist_to_no_tail_square_2.mp4" type="video/mp4" id="notail-lizard">
        Your browser does not support the video tag.
      </video>
      <figcaption style="align-self: center; margin-top: 20px; margin-bottom: 25px; width: 100%" >
        Video 4: no tail lizard experiment.
      </figcaption>
    </figure>
    <br/>

    <figure class="l-center">
      <video controls="" muted="" width="100%" height="100%">
        <source src="website/videos/static_properties/bug_to_butterfly_square_2.mp4" type="video/mp4" id="no-tail">
        Your browser does not support the video tag.
      </video>
      <figcaption style="align-self: center; margin-top: 20px; margin-bottom: 25px; width: 100%" >
        Video 5: bug to butterfly experiment.
      </figcaption>
    </figure>
    
    <details>
      <summary>
        <div class="l-body" style="display: flex; width: 100%; margin-left: 20px; margin-top: -35px">
          <div style="position: relative; margin-top:-px; width:60%">
            <h3 style="margin-top: 0em;" id="static-properties-extras">Extras</h3>
          </div>
        </div>
      </summary>
      <p>
        We found that adversaries trained to overtake the entire organism from a small 2x2 seed, oftentimes are robust to other
        cell injection patterns, in the following we show examples of this behavior.
      </p>

      <p>
        Cutting the tail of the lizard can also be done when starting from a spray pattern, where 
        1% of the original cells are randomly replaced by adversaries, or even starting from a single cell.
      </p>

      <figure class="l-center">
        <video controls="" muted="" width="100%" height="100%">
          <source src="website/videos/static_properties/lizard_persist_to_no_tail_1percent.mp4" type="video/mp4">
          Your browser does not support the video tag.
        </video>
        <figcaption style="align-self: center; margin-top: 20px; margin-bottom: 25px; width: 100%" >
          Video 6: the adversaries start from a spray pattern in which 1% of the original cells are substituted.
        </figcaption>
      </figure>
      <br/>

      <figure class="l-center">
        <video controls="" muted="" width="100%" height="100%">
          <source src="website/videos/static_properties/lizard_persist_to_no_tail_square_1.mp4" type="video/mp4">
          Your browser does not support the video tag.
        </video>
        <figcaption style="align-self: center; margin-top: 20px; margin-bottom: 25px; width: 100%" >
          Video 7: the adversaries start from a single cell.
        </figcaption>
      </figure>

      <p>
        We can turn a bug into a butterfly even if we start from spray patterns of different densities, like, 1% and 10%.
      </p>

      <figure class="l-center">
        <video controls="" muted="" width="100%" height="100%">
          <source src="website/videos/static_properties/bug_to_butterfly_1percent.mp4" type="video/mp4">
          Your browser does not support the video tag.
        </video>
        <figcaption style="align-self: center; margin-top: 20px; margin-bottom: 25px; width: 100%" >
          Video 8: the adversaries start from a spray pattern with 1% of cells substituted.
        </figcaption>
      </figure>
      <br/>

      <figure class="l-center">
        <video controls="" muted="" width="100%" height="100%">
          <source src="website/videos/static_properties/bug_to_butterfly_10percent.mp4" type="video/mp4">
          Your browser does not support the video tag.
        </video>
        <figcaption style="align-self: center; margin-top: 20px; margin-bottom: 25px; width: 100%" >
          Video 9: the adversaries start from a spray pattern with 10% of cells substituted.
        </figcaption>
      </figure>
    
      <p>
        While we said that the red lizard was the simplest one to train, it is also true that it is the adversary that is the least
        robust of the three, we think this is due to the training, since it took so few number of
        gradient updates to train, the adversaries didn't had the time to see a lot of different patterns. 
      </p>
    </details>
  </div>

  <div class="body" style="margin-top: 70px;">
    <h2 style="margin-top: 0em;" id="dynamic-properties">Changing dynamic properties</h2>
    <p>Below we show the evolution of the three Growing NCA used in the dynamic properties experiment, 
      as you can see the NCA quickly decay after reaching the target state.
    </p>
    <figure class="l-center">
      <video controls="" muted="" width="100%" height="100%">
        <source src="website/videos/dynamic_properties/lizard_butterfly_firework_growing.mp4" type="video/mp4">
        Your browser does not support the video tag.
      </video>
      <figcaption style="align-self: center; margin-top: 20px; margin-bottom: 25px; width: 100%" >
        Video 10: left: a growing lizard, center: a growing butterfly, right: a growing firework.
      </figcaption>
    </figure>
    <br/>

    <p>Below, the left panel shows the evolution of the organism,
      while the right panel shows where the cells are located, orange being the original cells and blue the adversaries.
    </p>
    <figure class="l-center">
      <video controls="" muted="" width="100%" height="100%">
        <source src="website/videos/dynamic_properties/lizard_grow_to_persist_square_3.mp4" type="video/mp4">
        Your browser does not support the video tag.
      </video>
      <figcaption style="align-self: center; margin-top: 20px; margin-bottom: 25px; width: 100%" >
        Video 11: lizard growing to persistent, the adversaries are injected in a 3x3 square seed.
      </figcaption>
    </figure>
    <br/>
  
    <figure class="l-center">
      <video controls="" muted="" width="100%" height="100%">
        <source src="website/videos/dynamic_properties/butterfly_grow_to_persist_3percent.mp4" type="video/mp4">
        Your browser does not support the video tag.
      </video>
      <figcaption style="align-self: center; margin-top: 20px; margin-bottom: 25px; width: 100%" >
        Video 12: butterfly growing to persistent, 3% of the cells are substituted in a spray pattern.
      </figcaption>
    </figure>
    <br/>

    <figure class="l-center">
      <video controls="" muted="" width="100%" height="100%">
        <source src="website/videos/dynamic_properties/firework_grow_to_persist_50percent.mp4" type="video/mp4">
        Your browser does not support the video tag.
      </video>
      <figcaption style="align-self: center; margin-top: 20px; margin-bottom: 25px; width: 100%" >
        Video 13: firework growing to persistent, 50% of cells are substituted in a spray pattern
      </figcaption>
    </figure>

    <details>
      <summary>
        <div class="l-body" style="display: flex; width: 100%; margin-left: 20px; margin-top: -35px">
          <div style="position: relative; margin-top:-px; width:60%">
            <h3 style="margin-top: 0em;" id="dynamic-properties-extras">Extras</h3>
          </div>
        </div>
      </summary>

      <p>Also dynamic properties can show robustness to other injection patterns.</p>
      <p>First, we have the lizard, which is able to turn into a persistent NCA even when we start from a spray pattern.</p>

      <figure class="l-center">
        <video controls="" muted="" width="100%" height="100%">
          <source src="website/videos/dynamic_properties/lizard_grow_to_persist_1percent.mp4" type="video/mp4">
          Your browser does not support the video tag.
        </video>
        <figcaption style="align-self: center; margin-top: 20px; margin-bottom: 25px; width: 100%" >
          Video 14: lizard growing to persistent, 1% of the cells are substituted in a spray pattern.
        </figcaption>
      </figure>

      <p>
        The butterfly, even though it was trained with 3% of cells substituted, works perfectly fine even with 1% of cells substituted.
      </p>

      <figure class="l-center">
        <video controls="" muted="" width="100%" height="100%">
          <source src="website/videos/dynamic_properties/butterfly_grow_to_persist_1percent.mp4" type="video/mp4">
          Your browser does not support the video tag.
        </video>
        <figcaption style="align-self: center; margin-top: 20px; margin-bottom: 25px; width: 100%" >
          Video 15: butterfly growing to persistent, 1% of the cells are substituted in a spray pattern.
        </figcaption>

      <p>
        These extra experiments, show how much the adversaries can adapt to out of distribution patterns,
        this property is essential in biological situations, where changing the behaviour of individual cells cannot be done with perfect accuracy.
        Having adversaries that work even for misplaced or random locations solves this problem at the root.
      </p>
    </details>
  </div>

</dt-article>



<!--Bibliography-->
<script type="text/bibliography">
  @article{mordvintsev2020growing,
    author = {Mordvintsev, Alexander and Randazzo, Ettore and Niklasson, Eyvind and Levin, Michael},
    title = {Growing Neural Cellular Automata},
    journal = {Distill},
    year = {2020},
    url = {https://distill.pub/2020/growing-ca},
  }

  @article{randazzo2021adversarial,
    author = {Randazzo, Ettore and Mordvintsev, Alexander and Niklasson, Eyvind and Levin, Michael},
    title = {Adversarial Reprogramming of Neural Cellular Automata},
    journal = {Distill},
    year = {2021},
    url = {https://distill.pub/selforg/2021/adversarial},
    doi = {10.23915/distill.00027.004}
  }
  @article{handberg2008stem,
    title={Stem cells and regeneration in planarians},
    author={Handberg-Thorsager, Mette and Fernandez, Enrique and Salo, Emili},
    journal={Front Biosci},
    volume={13},
    pages={6374--6394},
    year={2008},
    url ={https://www.fbscience.com/Landmark/articles/pdf/Landmark3160.pdf}
  }

  @article{TransmembraneVoltagePotential,
    author = {Pai, Vaibhav P. and Aw, Sherry and Shomrat, Tal and Lemire, Joan M. and Levin, Michael},
    title = {Transmembrane voltage potential controls embryonic eye patterning in Xenopus laevis},
    journal = {Development},
    volume = {139},
    number = {2},
    pages = {313-323},
    year = {2012},
    month = {01},
    issn = {0950-1991},
    doi = {10.1242/dev.073759},
    url = {https://doi.org/10.1242/dev.073759},
    eprint = {https://journals.biologists.com/dev/article-pdf/139/2/313/1160014/313.pdf}
  }
</script>

<script src="https://d3js.org/d3.v4.js"></script>
<script src="website/grid_value.js" type="text/javascript"></script>
<script src="website/grid_yellow_value.js" type="text/javascript"></script>
<script src="website/grid.js" type="text/javascript"></script>
<script src="website/epoch_loss.js"></script>
<script src="website/epoch_loss_growing.js"></script>
<script>
window.addEventListener("resize", function(){
    onresize1();
    onresize2();
  });
</script>